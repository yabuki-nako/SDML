  <div class="mb-5">
  <div class="row d-flex justify-content-center align-items-center h-100 " >
    <div class="col col-xl-10">
      <div class="card" style="border-radius: 1rem; background-color: #fcfcfc">
        <div class="card-body p-4 p-lg- text-black">
          <h3> Our Doctors</h3>
          <hr class="app">
          <select name="specialty" class="form-control-lg mb-3">
            <option disabled selected>Select department</option>
            <?php
            while ($row = $result->fetch_assoc()) {
              $sname = $row['sname'];
              echo "<option value='$sname'>$sname</option>";
            }
            ?>

          </select>
          <?php
            while ($row = $result2->fetch_assoc()) {
              echo'';
            }
            ?>  <div class="doctor">

            <div class="row ml-2">
              
              <div class="col-2 d-flex flex-row" >
              <div class="doctext">
                <div class="member">
                  <img src="assets/img/team/team-1.jpg" class="img-fluid">
                  <h3>Jose De Leon</h3>
                  <h5>Specialty</H5><h4>Neuro</h4>
                  <h5>Email</H5><h4>asdassssasd@gmail.com</h4>

                </div>
              </div>
            
              
              <!-- content -->
            </div>
          </div>
          <!-- row -->
        </div>
      </div>
    </div>
  </div>
</div>
          </div>



          <div class="row gy-4">

<div class="col-xl-4 col-md-6 portfolio-item filter-app">
  <div class="portfolio-wrap">
    <a href="assets/img/portfolio/app-1.jpg"><img src="assets/img/portfolio/app-1.jpg" class="img-fluid" alt=""></a>
    <div class="portfolio-info">
      <h4><a href="portfolio-details.html" title="More Details">App 1</a></h4>
      <p>Lorem ipsum, dolor sit amet consectetur</p>
    </div>
  </div>
</div><!-- End Portfolio Item -->

<div class="col-xl-3 col-md-6 portfolio-item filter-app" >
<div class="portfolio-wrap">
    <div class="portfolio-info">
      <img src="assets/img/team/team-1.jpg" class="img-fluid">
      <h3>Jose De Leon</h3>
      <h5>Specialty</H5><h4>Neuro</h4>
      <h5>Email</H5><h4>asdassssasd@gmail.com</h4>

    </div>
  </div>
</div>

<div class="col-xl-3 col-md-6 portfolio-item filter-app" >
<div class="portfolio-wrap">
    <div class="portfolio-info">
      <img src="assets/img/team/team-1.jpg" class="img-fluid">
      <h3>Jose De Leon</h3>
      <h5>Specialty</H5><h4>Neuro</h4>
      <h5>Email</H5><h4>asdassssasd@gmail.com</h4>

    </div>
  </div>
</div>
<div class="col-xl-3 col-md-6 portfolio-item filter-app" >
<div class="portfolio-wrap">
    <div class="portfolio-info">
      <img src="assets/img/team/team-1.jpg" class="img-fluid">
      <h3>Jose De Leon</h3>
      <h5>Specialty</H5><h4>Neuro</h4>
      <h5>Email</H5><h4>asdassssasd@gmail.com</h4>

    </div>
  </div>
</div>
</div>

<!-- tEST FOR rESET PASS -->

<?php
// Initialize the session
session_start();
 
// Check if the user is logged in, otherwise redirect to login page
if(!isset($_SESSION["loggedin"]) || $_SESSION["loggedin"] !== true){
    header("location: login.php");
    exit;
}
 
// Include config file
require_once "config.php";
 
// Define variables and initialize with empty values
$new_password = $confirm_password = "";
$new_password_err = $confirm_password_err = "";
 
// Processing form data when form is submitted
if($_SERVER["REQUEST_METHOD"] == "POST"){
 
    // Validate new password
    if(empty(trim($_POST["new_password"]))){
        $new_password_err = "Please enter the new password.";     
    } elseif(strlen(trim($_POST["new_password"])) < 6){
        $new_password_err = "Password must have atleast 6 characters.";
    } else{
        $new_password = trim($_POST["new_password"]);
    }
    
    // Validate confirm password
    if(empty(trim($_POST["confirm_password"]))){
        $confirm_password_err = "Please confirm the password.";
    } else{
        $confirm_password = trim($_POST["confirm_password"]);
        if(empty($new_password_err) && ($new_password != $confirm_password)){
            $confirm_password_err = "Password did not match.";
        }
    }
        
    // Check input errors before updating the database
    if(empty($new_password_err) && empty($confirm_password_err)){
        // Prepare an update statement
        $sql = "UPDATE patient_detail SET password = ? WHERE pid = ?";
        
        if($stmt = $mysqli->prepare($sql)){
            // Bind variables to the prepared statement as parameters
            $stmt->bind_param("si", $param_password, $param_id);
            
            // Set parameters
            $param_password = password_hash($new_password, PASSWORD_DEFAULT);
            $param_id = $_SESSION["id"];
            
            // Attempt to execute the prepared statement
            if($stmt->execute()){
                // Password updated successfully. Destroy the session, and redirect to login page
                echo '<script>alert("Password Change")</script>';
                header("location: welcomepatient.php");
                    
                exit();
            } else{
                echo "Oops! Something went wrong. Please try again later.";
            }

            // Close statement
            $stmt->close();
        }
    }
    
    // Close connection
    $mysqli->close();
}
?>
 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Reset Password</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body{ font: 14px sans-serif; }
        .wrapper{ width: 360px; padding: 20px; }
    </style>
</head>
<body>
    <div class="wrapper">
        <h2>Reset Password</h2>
        <p>Please fill out this form to reset your password.</p>
        <form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="post"> 
            <div class="form-group">
                <label>New Password</label>
                <input type="password" name="new_password" class="form-control <?php echo (!empty($new_password_err)) ? 'is-invalid' : ''; ?>" value="<?php echo $new_password; ?>">
                <span class="invalid-feedback"><?php echo $new_password_err; ?></span>
            </div>
            <div class="form-group">
                <label>Confirm Password</label>
                <input type="password" name="confirm_password" class="form-control <?php echo (!empty($confirm_password_err)) ? 'is-invalid' : ''; ?>">
                <span class="invalid-feedback"><?php echo $confirm_password_err; ?></span>
            </div>
            <div class="form-group">
                <input type="submit" class="btn btn-primary" value="Submit">
                <a class="btn btn-link ml-2" href="welcome.php">Cancel</a>
            </div>
        </form>
    </div>    
</body>
</html>

<!-- tester! -->
<?php
// Initialize the session
session_start();
require_once "config.php";
// time and date
$today = date("F j, Y ");
// Check if the user is logged in, if not then redirect him to login page
if(!isset($_SESSION["loggedin"]) || $_SESSION["loggedin"] !== true){
    header("location: login.php");
    exit;
}


if ($_SERVER['REQUEST_METHOD'] === 'POST') {
  $docid = $_POST['docid'];
  $appDate = $_POST['appDate'];
  $appTime = $_POST['appTime'];

  echo "Name: " . $docid . "<br>";
  echo "Email: " . $appDate . "<br>";
  echo "Email: " . $appTime . "<br>";
}

$sql = "SELECT  doctor.docid ,doctor.docname, specialties.id,specialties.sname
FROM doctor
JOIN specialties ON doctor.specialties = specialties.id;";
$result = $mysqli->query($sql);
?>
 
 <!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Impact Bootstrap Template - Index</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

 
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Raleway:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/owlcarousel/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <!-- Template Main CSS File -->
  <link href="assets/css/patient.css" rel="stylesheet">
  <!-- TIMER FUNCTION -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function(){
      updateTime(); 
      setInterval(updateTime, 1000); 
    });

    function updateTime() {
      $.ajax({
        url: 'get_time.php', 
        type: 'GET',
        success: function(data) {
          $('#time').text(data); 
        }
      });
    }
  </script>
  <!-- =======================================================
  * Template Name: Impact
  * Updated: May 30 2023 with Bootstrap v5.3.0
  * Template URL: https://bootstrapmade.com/impact-bootstrap-business-website-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>
<body>

<header id="header" class="header d-flex align-items-center">

    <div class="container-fluid container-xl d-flex align-items-center justify-content-between">
      <a href="" class="logo d-flex align-items-center">

        <h1>Makiling Clinic</h1>


        <nav id="navbar" class="navbar">
        <ul>
          <li><a href="welcomepatient.php">Home</a></li>
          <li><a href="booking.php">Appointment booking</a></li>
          <li><a href="#services">Appointment History</a></li>
          <li class="dropdown"><a href="#"><span>Profile</span> <i class="bi bi-chevron-down dropdown-indicator"></i></a>
            <ul>
              <li><a data-bs-toggle="modal" data-bs-target="#userdetail">View Account details</a></li> 

              <li><a href="resetpass.php">Reset Password</a></li>    
              <li><a href="logout.php">Log Out</a></li>
            </ul>
          </li>
        </ul>
      </nav><!-- .navbar --><!-- .navbar -->



  </header>
      <div class="d-flex justify-content-center ">

        <div class="mt-4 mb-0">
              <h4><b>&nbsp;Today's Date and Time&nbsp;</b>
              <div class="d-flex"> <?php echo $today?>&nbsp;||&nbsp;<div id="time"></h4>
         

         
        </div>
      </div>
    </div>
    <div class="container py-10 h-100 mb-5 mt-5">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col col-xl-8">
        <div class="card" style="border-radius: 1rem; background-color: white;">
          <div class="row gx-">
            <div class="col-md-10 col-lg-12 d-flex align-items-center">
              <div class="card-body p-4 p-lg-5 text-black">
                <form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="post" id="appointment">
                  <div class="d-flex align-items-center mb-3 pb-1 mr">
                    <span class="h1 fw-bold mb-0">Book appointment</span>
                  </div>

                  <div class="form-outline mb-4">
                    <label class="form-label" for="gender">Select doctor</label>
                    <select name="docid" class="form-control form-control-lg <?php echo (!empty($docname_err)) ? 'is-invalid' : ''; ?>">
    <option disabled selected>Select doctor</option>
    <?php
    while ($row = $result->fetch_assoc()) {
        $docid = $row['docid'];
        $sname = $row['sname'];
        $docname = $row['docname'];
        echo "<option value='$docid'>$sname - $docname</option>";
    }
    ?>
</select>
                    <span class="invalid-feedback"><?php echo $docname_err; ?></span>
                  </div>
                  <div class="form-outline mb-4">
                  <label class="form-label" for="form2Example27">Appointment Date</label>
                    <input type="date" id="appDate"  name="appDate" onkeydown="return false" onfocus="blur()"  class="form-control form-control-lg <?php echo (!empty($appDate_err)) ? 'is-invalid' : ''; ?>" value="<?php echo $appDate; ?>">
                    <span class="invalid-feedback"><?php echo $appDate_err; ?></span>
                  </div>
                  <div class="form-outline mb-4">
                  <!-- <label class="form-label" for="form2Example27">Appointment Time</label>
                  <input type="time" id="appTime" name="appTime"  min="09:00" max="18:00" class="form-control form-control-lg"required>
                  </div> -->
                  <div class="form-outline mb-">
                    <label class="form-label" for="appTime">Select Time</label>
                    <select name="appTime" class="form-control form-control-lg<?php echo (!empty($appTime_err)) ? 'is-invalid' : ''; ?>" value="<?php echo $appTIme; ?>">
                    <option disabled selected>Select Time</option>
                    <option value="8">8:00 AM - 9:00 AM</option>
                    <option value="9">9:00 AM - 10:0 0AM</option>
                    <option value="10">10:00 AM - 11:00 AM</option>
                    <option value="11">11:00 PM- 12:00 PM</option>
                    <option disabled selected>Break TIme</option>
                    <option value="1">1:00 PM - 2:00PM</option>
                    <option value="2">2:00 PM - 3:00PM</option>
                    <option value="3">3:00 PM - 4:00PM</option>
                    <option value="4">4:00 PM - 5:00PM</option>
                    <option value="5">5:00 PM - 6:00PM</option>
                  </select>       
                  <span class="invalid-feedback"><?php echo $appTime_err; ?></span>           
                  </div>
                  <div class="pt-1 mb-4">
                    <input type="submit" class="btn btn-dark btn-lg" value="Submit"><br><br>
                    <p class="mb-0 pb-lg-2" style="color: #393f81;"><a href="Loginemp.php"></a></p>
                  </div>
                </form>
                <table class="table table-bordered table-default w-">
            <thead class="table-secondary">
                    <th>Doctor name</th>
                    <th>Specialty ID</th>
                    <th>Specialties</th>

                    </div>
                </tr>
            </thead>

        </tbody>
        <?php
        // Loop through the result set and generate table rows
        $sql = "SELECT  doctor.docname, specialties.id,specialties.sname
FROM doctor
JOIN specialties ON doctor.specialties = specialties.id;";
$result = $mysqli->query($sql); 
        if ($result->num_rows > 0) {
            while ($row = $result->fetch_assoc()) {
                echo "<tr>";
                echo "<td>" . $row['docname'] . "</td>";
                echo "<td>" . $row['id'] . "</td>";
                echo "<td>" . $row['sname'] . "</td>";
                echo "</tr>";
            }
        } else {
            echo "<tr><td colspan='4'>No data available</td></tr>";
        }
        ?>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <!-- Modal -->
  <div class="modaltext">
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Account Details</h1>
      </div>
      <div class="modal-body">
      <h5>Name</H5><h3 ><?php echo htmlspecialchars($_SESSION["pname"]); ?></h3>
      <h5 class ="mt-3">Email</H5><h3 ><?php echo htmlspecialchars($_SESSION["email"]); ?></h3>
      <h5 class ="mt-3">Cellphone Number</H5><h3 ><?php echo htmlspecialchars($_SESSION["pcellphone"]); ?></h3>
      <h5 class ="mt-3">Gender</H5><h3 ><?php echo htmlspecialchars($_SESSION["pGender"]); ?></h3>
      <h5 class ="mt-3">Birthday</H5><h3 ><?php echo htmlspecialchars($_SESSION["pBirthday"]); ?></h3>
      <h5 class ="mt-3">Address</H5><h3 ><?php echo htmlspecialchars($_SESSION["pAddress"]); ?></h3>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
      </div>
</body>
<!-- Vendor JS Files -->
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/aos/aos.js"></script>
<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>
<script src="assets/owlcarousel/owl.carousel.js"></script>
<script src="assets/owlcarousel/owl.carousel.min.js"></script>


<!-- Template Main JS File -->
<script src="assets/js/main.js"></script>

</body>

</html>

<!-- sd -->
<?php
// Initialize the session
session_start();
require_once "config.php";
// time and date
$today = date("F j, Y ");
// Check if the user is logged in, if not then redirect him to login page
if(!isset($_SESSION["loggedin"]) || $_SESSION["loggedin"] !== true){
    header("location: login.php");
    exit;
}

// Define variables and initialize with empty values
$appTIme = $appDate = $docid = "";
$appTime_err = $appDate_err = $docid_err = "";
$docid = intval($docid);
// Processing form data when form is submitted
if($_SERVER["REQUEST_METHOD"] == "POST"){
 
  // Validate Time
  // if(empty(trim($_POST["appTime"]))){
  //     $email_err = "Please Select Time.";
  // } elseif(!preg_match('/^[a-zA-Z0-9_@.]+$/', trim($_POST["email"]))){
  //     $email_err = "email can only contain letters, numbers, and underscores.";
  // } else{
    if(empty($_POST["appTime"])){
      $appTime_err = "Please select application TIme.";     
  } else{
      $appTime = trim($_POST["appTime"]);
  
      // Prepare a select statement
      $sql1 = "SELECT a.appointment_ID, a.docid, d.docname, a.pid, a.appDate, a.appTime, a.App_status
      FROM appointments a
      JOIN doctor d ON a.docid = d.docid where a.docid = ? and appTime = ? and appDate = ?";
      
      if($stmt = $mysqli->prepare($sql1)){
          // Bind variables to the prepared statement as parameters
          $stmt->bind_param("sss", $param_appTime, $param_appDate, $param_docid);
          
          // Set parameters
          $param_docid= trim($_POST["docid"]);
          $param_appDate= trim($_POST["appDate"]);
          $param_appTime= trim($_POST["appTime"]);

          
          // Attempt to execute the prepared statement
          if($stmt->execute()){
              // store result
              $stmt->store_result();
              
              if($stmt->num_rows == 1){
                  $appTime_err = "This Appointment is already taken.";
              } else{
                  $appTime= trim($_POST["appTime"]);
              }
          } else{
              echo "Oops! Something went wrong. Please try again later.";
          }

          // Close statement
          $stmt->close();
      }
  }
  

  
  // Validate gender
//   if(empty($_POST["docname"])){
//     $docname_err = "Please select doctor.";     
// } else{
//     $docname = trim($_POST["docname"]);
// }

//     // Validate Birthday
//     if(empty($_POST["appDate"])){
//       $appDate_err = "Please select birthday.";     
//   } else{
//       $appDate = trim($_POST["appDate"]);
//   }

  // Check input errors before inserting in database
  if(empty($appDate_err) && empty($appTime_err) && empty($docid_err)){
      
      // Prepare an insert statement
      $sql2 = "INSERT INTO appointments (pid, docid, appdate, apptime) VALUES (?, ?, ?, ?)";
       
      if($stmt = $mysqli->prepare($sql2)){
          // Bind variables to the prepared statement as parameters
          $stmt->bind_param("ssss",$param_docid, $param_pid, $param_appDate, $param_appTime);
          
          // Set parameters
          $param_pid = $_SESSION['id'];
          $param_appDate = $appDate;
          $param_appTime = $appTIme;
          $param_docid = $docid;// Creates a password hash
          // Attempt to execute the prepared statement
          if($stmt->execute()){
              // Redirect to login page
              header("location: welcomepatient.php");
          } else{
              echo "Oops! Something went wrong. Please try again later.";
          }

          // Close statement
          $stmt->close();
      }
  }
  
  // Close connection

}
$sql = "SELECT  doctor.docname, specialties.id,specialties.sname
FROM doctor
JOIN specialties ON doctor.specialties = specialties.id;";
$result = $mysqli->query($sql);
?>
 
 <!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Impact Bootstrap Template - Index</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

 
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Raleway:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/owlcarousel/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <!-- Template Main CSS File -->
  <link href="assets/css/patient.css" rel="stylesheet">
  <!-- TIMER FUNCTION -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function(){
      updateTime(); 
      setInterval(updateTime, 1000); 
    });

    function updateTime() {
      $.ajax({
        url: 'get_time.php', 
        type: 'GET',
        success: function(data) {
          $('#time').text(data); 
        }
      });
    }
  </script>
  <!-- =======================================================
  * Template Name: Impact
  * Updated: May 30 2023 with Bootstrap v5.3.0
  * Template URL: https://bootstrapmade.com/impact-bootstrap-business-website-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>
<body>

<header id="header" class="header d-flex align-items-center">

    <div class="container-fluid container-xl d-flex align-items-center justify-content-between">
      <a href="" class="logo d-flex align-items-center">

        <h1>Makiling Clinic</h1>


        <nav id="navbar" class="navbar">
        <ul>
          <li><a href="welcomepatient.php">Home</a></li>
          <li><a href="booking.php">Appointment booking</a></li>
          <li><a href="#services">Appointment History</a></li>
          <li class="dropdown"><a href="#"><span>Profile</span> <i class="bi bi-chevron-down dropdown-indicator"></i></a>
            <ul>
              <li><a data-bs-toggle="modal" data-bs-target="#userdetail">View Account details</a></li> 

              <li><a href="resetpass.php">Reset Password</a></li>    
              <li><a href="logout.php">Log Out</a></li>
            </ul>
          </li>
        </ul>
      </nav><!-- .navbar --><!-- .navbar -->



  </header>
  <div class="d-flex justify-content-center ">

<div class="mt-4 mb-0">
      <h4><b>&nbsp;Today's Date and Time&nbsp;</b>
      <div class="d-flex"> <?php echo $today?>&nbsp;||&nbsp;<div id="time"></h4>
 

 
</div>
</div>
</div>
<div class="container py-10 h-100 mb-5 mt-5">
<div class="row d-flex justify-content-center align-items-center h-100">
<div class="col col-xl-8">
<div class="card" style="border-radius: 1rem; background-color: white;">
  <div class="row gx-">
    <div class="col-md-10 col-lg-12 d-flex align-items-center">
      <div class="card-body p-4 p-lg-5 text-black">
        <form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="post" id="appointment">
          <div class="d-flex align-items-center mb-3 pb-1 mr">
            <span class="h1 fw-bold mb-0">Book appointment</span>
          </div>

          <div class="form-outline mb-4">
            <label class="form-label" for="gender">Select doctor</label>
            <select name="docid" class="form-control form-control-lg <?php echo (!empty($docname_err)) ? 'is-invalid' : ''; ?>">
<option disabled selected>Select doctor</option>
<?php
while ($row = $result->fetch_assoc()) {
$docid = $row['docid'];
$sname = $row['sname'];
$docname = $row['docname'];
echo "<option value='$docid'>$sname - $docname</option>";

}
?>
</select>
            <span class="invalid-feedback"><?php echo $docname_err; ?></span>
          </div>
          <div class="form-outline mb-4">
          <label class="form-label" for="form2Example27">Appointment Date</label>
            <input type="date" id="appDate"  name="appDate" onkeydown="return false" onfocus="blur()"  class="form-control form-control-lg <?php echo (!empty($appDate_err)) ? 'is-invalid' : ''; ?>" value="<?php echo $appDate; ?>">
            <span class="invalid-feedback"><?php echo $appDate_err; ?></span>
          </div>
          <div class="form-outline mb-4">
          <!-- <label class="form-label" for="form2Example27">Appointment Time</label>
          <input type="time" id="appTime" name="appTime"  min="09:00" max="18:00" class="form-control form-control-lg"required>
          </div> -->
          <div class="form-outline mb-">
            <label class="form-label" for="appTime">Select Time</label>
            <select name="appTime" class="form-control form-control-lg<?php echo (!empty($appTime_err)) ? 'is-invalid' : ''; ?>" value="<?php echo $appTIme; ?>">
            <option disabled selected>Select Time</option>
            <option value="8">8:00 AM - 9:00 AM</option>
            <option value="9">9:00 AM - 10:0 0AM</option>
            <option value="10">10:00 AM - 11:00 AM</option>
            <option value="11">11:00 PM- 12:00 PM</option>
            <option disabled selected>Break TIme</option>
            <option value="1">1:00 PM - 2:00PM</option>
            <option value="2">2:00 PM - 3:00PM</option>
            <option value="3">3:00 PM - 4:00PM</option>
            <option value="4">4:00 PM - 5:00PM</option>
            <option value="5">5:00 PM - 6:00PM</option>
          </select>       
          <span class="invalid-feedback"><?php echo $appTime_err; ?></span>           
          </div>
          <div class="pt-1 mb-4">
            <input type="submit" class="btn btn-dark btn-lg" value="Submit"><br><br>
            <p class="mb-0 pb-lg-2" style="color: #393f81;"><a href="Loginemp.php"></a></p>
          </div>
        </form>
        <table class="table table-bordered table-default w-">
    <thead class="table-secondary">
            <th>Doctor name</th>
            <th>Specialty ID</th>
            <th>Specialties</th>

            </div>
        </tr>
    </thead>

</tbody>
<?php
// Loop through the result set and generate table rows
$sql = "SELECT  doctor.docname, specialties.id,specialties.sname
FROM doctor
JOIN specialties ON doctor.specialties = specialties.id;";
$result = $mysqli->query($sql); 
if ($result->num_rows > 0) {
    while ($row = $result->fetch_assoc()) {
        echo "<tr>";
        echo "<td>" . $row['docname'] . "</td>";
        echo "<td>" . $row['id'] . "</td>";
        echo "<td>" . $row['sname'] . "</td>";
        echo "</tr>";
    }
} else {
    echo "<tr><td colspan='4'>No data available</td></tr>";
}
?>
      </div>
    </div>
  </div>
</div>
</div>
</div>
</div>

  <!-- Modals -->
  <!-- Modal -->
  <div class="modaltext">
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Account Details</h1>
      </div>
      <div class="modal-body">
      <h5>Name</H5><h3 ><?php echo htmlspecialchars($_SESSION["pname"]); ?></h3>
      <h5 class ="mt-3">Email</H5><h3 ><?php echo htmlspecialchars($_SESSION["email"]); ?></h3>
      <h5 class ="mt-3">Cellphone Number</H5><h3 ><?php echo htmlspecialchars($_SESSION["pcellphone"]); ?></h3>
      <h5 class ="mt-3">Gender</H5><h3 ><?php echo htmlspecialchars($_SESSION["pGender"]); ?></h3>
      <h5 class ="mt-3">Birthday</H5><h3 ><?php echo htmlspecialchars($_SESSION["pBirthday"]); ?></h3>
      <h5 class ="mt-3">Address</H5><h3 ><?php echo htmlspecialchars($_SESSION["pAddress"]); ?></h3>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
      </div>
</body>
<!-- Vendor JS Files -->
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/aos/aos.js"></script>
<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>
<script src="assets/owlcarousel/owl.carousel.js"></script>
<script src="assets/owlcarousel/owl.carousel.min.js"></script>


<!-- Template Main JS File -->
<script src="assets/js/main.js"></script>

</body>

</html>
$docid = intval($docid);

<!-- test -->
<?php
// Initialize the session
session_start();
require_once "config.php";
// time and date
$today = date("F j, Y ");
// Check if the user is logged in, if not then redirect him to login page
if(!isset($_SESSION["loggedin"]) || $_SESSION["loggedin"] !== true){
    header("location: login.php");
    exit;
}


if ($_SERVER['REQUEST_METHOD'] === 'POST') {
  $docid = $_POST['docid'];
  $appDate = $_POST['appDate'];
  $appTime = $_POST['appTime'];
$docid = intval($docid);

  echo "Name: " .gettype($docid).$docid . "<br>";
  echo "Email: " . $appDate . "<br>";
  echo "Email: " . $appTime . "<br>";
}

$sql = "SELECT  doctor.docid ,doctor.docname, specialties.id,specialties.sname
FROM doctor
JOIN specialties ON doctor.specialties = specialties.id;";
$result = $mysqli->query($sql);
?>
 
 <!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Impact Bootstrap Template - Index</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

 
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Raleway:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/owlcarousel/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <!-- Template Main CSS File -->
  <link href="assets/css/patient.css" rel="stylesheet">
  <!-- TIMER FUNCTION -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function(){
      updateTime(); 
      setInterval(updateTime, 1000); 
    });

    function updateTime() {
      $.ajax({
        url: 'get_time.php', 
        type: 'GET',
        success: function(data) {
          $('#time').text(data); 
        }
      });
    }
  </script>
  <!-- =======================================================
  * Template Name: Impact
  * Updated: May 30 2023 with Bootstrap v5.3.0
  * Template URL: https://bootstrapmade.com/impact-bootstrap-business-website-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>
<body>

<header id="header" class="header d-flex align-items-center">

    <div class="container-fluid container-xl d-flex align-items-center justify-content-between">
      <a href="" class="logo d-flex align-items-center">

        <h1>Makiling Clinic</h1>


        <nav id="navbar" class="navbar">
        <ul>
          <li><a href="welcomepatient.php">Home</a></li>
          <li><a href="booking.php">Appointment booking</a></li>
          <li><a href="#services">Appointment History</a></li>
          <li class="dropdown"><a href="#"><span>Profile</span> <i class="bi bi-chevron-down dropdown-indicator"></i></a>
            <ul>
              <li><a data-bs-toggle="modal" data-bs-target="#userdetail">View Account details</a></li> 

              <li><a href="resetpass.php">Reset Password</a></li>    
              <li><a href="logout.php">Log Out</a></li>
            </ul>
          </li>
        </ul>
      </nav><!-- .navbar --><!-- .navbar -->



  </header>
      <div class="d-flex justify-content-center ">

        <div class="mt-4 mb-0">
              <h4><b>&nbsp;Today's Date and Time&nbsp;</b>
              <div class="d-flex"> <?php echo $today?>&nbsp;||&nbsp;<div id="time"></h4>
         

         
        </div>
      </div>
    </div>
    <div class="container py-10 h-100 mb-5 mt-5">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col col-xl-8">
        <div class="card" style="border-radius: 1rem; background-color: white;">
          <div class="row gx-">
            <div class="col-md-10 col-lg-12 d-flex align-items-center">
              <div class="card-body p-4 p-lg-5 text-black">
                <form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="post" id="appointment">
                  <div class="d-flex align-items-center mb-3 pb-1 mr">
                    <span class="h1 fw-bold mb-0">Book appointment</span>
                  </div>

                  <div class="form-outline mb-4">
                    <label class="form-label" for="gender">Select doctor</label>
                    <select name="docid" class="form-control form-control-lg <?php echo (!empty($docname_err)) ? 'is-invalid' : ''; ?>">
    <option disabled selected>Select doctor</option>
    <?php
    while ($row = $result->fetch_assoc()) {
        $docid = $row['docid'];
        $sname = $row['sname'];
        $docname = $row['docname'];
        echo "<option value='" . (int)$docid . "'>$sname - $docname</option>";
        
    }
    ?>
</select>
                    <span class="invalid-feedback"><?php echo $docname_err; ?></span>
                  </div>
                  <div class="form-outline mb-4">
                  <label class="form-label" for="form2Example27">Appointment Date</label>
                    <input type="date" id="appDate"  name="appDate" onkeydown="return false" onfocus="blur()"  class="form-control form-control-lg <?php echo (!empty($appDate_err)) ? 'is-invalid' : ''; ?>" value="<?php echo $appDate; ?>">
                    <span class="invalid-feedback"><?php echo $appDate_err; ?></span>
                  </div>
                  <div class="form-outline mb-4">
                  <!-- <label class="form-label" for="form2Example27">Appointment Time</label>
                  <input type="time" id="appTime" name="appTime"  min="09:00" max="18:00" class="form-control form-control-lg"required>
                  </div> -->
                  <div class="form-outline mb-">
                    <label class="form-label" for="appTime">Select Time</label>
                    <select name="appTime" class="form-control form-control-lg<?php echo (!empty($appTime_err)) ? 'is-invalid' : ''; ?>" value="<?php echo $appTIme; ?>">
                    <option disabled selected>Select Time</option>
                    <option value="8">8:00 AM - 9:00 AM</option>
                    <option value="9">9:00 AM - 10:0 0AM</option>
                    <option value="10">10:00 AM - 11:00 AM</option>
                    <option value="11">11:00 PM- 12:00 PM</option>
                    <option disabled selected>Break TIme</option>
                    <option value="1">1:00 PM - 2:00PM</option>
                    <option value="2">2:00 PM - 3:00PM</option>
                    <option value="3">3:00 PM - 4:00PM</option>
                    <option value="4">4:00 PM - 5:00PM</option>
                    <option value="5">5:00 PM - 6:00PM</option>
                  </select>       
                  <span class="invalid-feedback"><?php echo $appTime_err; ?></span>           
                  </div>
                  <div class="pt-1 mb-4">
                    <input type="submit" class="btn btn-dark btn-lg" value="Submit"><br><br>
                    <p class="mb-0 pb-lg-2" style="color: #393f81;"><a href="Loginemp.php"></a></p>
                  </div>
                </form>
                <table class="table table-bordered table-default w-">
            <thead class="table-secondary">
                    <th>Doctor name</th>
                    <th>Specialty ID</th>
                    <th>Specialties</th>

                    </div>
                </tr>
            </thead>

        </tbody>
        <?php
        // Loop through the result set and generate table rows
        $sql = "SELECT  doctor.docname, specialties.id,specialties.sname
FROM doctor
JOIN specialties ON doctor.specialties = specialties.id;";
$result = $mysqli->query($sql); 
        if ($result->num_rows > 0) {
            while ($row = $result->fetch_assoc()) {
                echo "<tr>";
                echo "<td>" . $row['docname'] . "</td>";
                echo "<td>" . $row['id'] . "</td>";
                echo "<td>" . $row['sname'] . "</td>";
                echo "</tr>";
            }
        } else {
            echo "<tr><td colspan='4'>No data available</td></tr>";
        }
        ?>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <!-- Modal -->
  <div class="modaltext">
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Account Details</h1>
      </div>
      <div class="modal-body">
      <h5>Name</H5><h3 ><?php echo htmlspecialchars($_SESSION["pname"]); ?></h3>
      <h5 class ="mt-3">Email</H5><h3 ><?php echo htmlspecialchars($_SESSION["email"]); ?></h3>
      <h5 class ="mt-3">Cellphone Number</H5><h3 ><?php echo htmlspecialchars($_SESSION["pcellphone"]); ?></h3>
      <h5 class ="mt-3">Gender</H5><h3 ><?php echo htmlspecialchars($_SESSION["pGender"]); ?></h3>
      <h5 class ="mt-3">Birthday</H5><h3 ><?php echo htmlspecialchars($_SESSION["pBirthday"]); ?></h3>
      <h5 class ="mt-3">Address</H5><h3 ><?php echo htmlspecialchars($_SESSION["pAddress"]); ?></h3>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
      </div>
</body>
<!-- Vendor JS Files -->
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/aos/aos.js"></script>
<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>
<script src="assets/owlcarousel/owl.carousel.js"></script>
<script src="assets/owlcarousel/owl.carousel.min.js"></script>


<!-- Template Main JS File -->
<script src="assets/js/main.js"></script>

</body>

</html>


<!-- Draft -->
<?php
// Initialize the session
session_start();
require_once "config.php";
// time and date
$today = date("F j, Y ");
// Check if the user is logged in, if not then redirect him to login page
if(!isset($_SESSION["loggedin"]) || $_SESSION["loggedin"] !== true){
    header("location: login.php");
    exit;
}

// Define variables and initialize with empty values
$appTIme = $appDate = $docid = "";
$appTime_err = $appDate_err = $docid_err = "";
$docid = intval($docid);



// Processing form data when form is submitted
if($_SERVER["REQUEST_METHOD"] == "POST"){

  // Validate Time
  // if(empty(trim($_POST["appTime"]))){
  //     $email_err = "Please Select Time.";
  // } elseif(!preg_match('/^[a-zA-Z0-9_@.]+$/', trim($_POST["email"]))){
  //     $email_err = "email can only contain letters, numbers, and underscores.";
  // } else{
    if(empty($_POST["appTime"])){
      $appTime_err = "Please select application TIme.";     
  } else{
      $appTime = trim($_POST["appTime"]);
  
      // Prepare a select statement
      $sql1 = "SELECT a.appointment_ID, a.docid, d.docname, a.pid, a.appDate, a.appTime, a.App_status
      FROM appointments a
      JOIN doctor d ON a.docid = d.docid where a.docid = ? and appTime = ? and appDate = ?";
      
      if($stmt = $mysqli->prepare($sql1)){
          // Bind variables to the prepared statement as parameters
          $stmt->bind_param("sss", $param_appTime, $param_appDate, $param_docid);
          $appTime = intval($appTime);
          // Set parameters
          $param_docid = trim($_POST["docid"]);
          $param_appDate= trim($_POST["appDate"]);
          $param_appTime= trim($_POST["appTime"]);
          
          
          // Attempt to execute the prepared statement
          if($stmt->execute()){
              // store result
              $stmt->store_result();
              
              if($stmt->num_rows == 1){
                  $appTime_err = "This Appointment is already taken.";
              } else{
                  $appTime= trim($_POST["docid"]);
                  $appTime= trim($_POST["appTime"]);
                  $appTime= trim($_POST["appDate"]);

              }
          } else{
              echo "Oops! Something went wrong. Please try again later.";
          }

          // Close statement
          $stmt->close();
      }
  }
  

  
//  Validate gender
//   if(empty($_POST["docid"])){
//     $docid_err = "Please select doctor.";     
// } else{
//     $docid = trim($_POST["docid"]);
// }

    // Validate Birthday
    if(empty($_POST["appDate"])){
      $appDate_err = "Please select birthday.";     
  } else{
      $appDate = trim($_POST["appDate"]);
  }

  // Check input errors before inserting in database
  if(empty($appDate_err) && empty($appTime_err) && empty($docid_err)){
    $appTime = intval($appTime);
      // Prepare an insert statement
      $sql2 = "INSERT INTO appointments (docid, pId,  appDate, appTime) VALUES (?, ?, ?, ?)";
       
      if($stmt = $mysqli->prepare($sql2)){
          // Bind variables to the prepared statement as parameters
          $stmt->bind_param("ssss",$param_docid, $param_pid, $param_appDate, $param_appTime);
          
          // Set parameters
          
          $param_pid = $_SESSION['id'];
          $param_docid = $docid;
          $param_appDate = $appDate;
          $param_appTime = $appTime;

          // Attempt to execute the prepared statement
          if($stmt->execute()){
              // Redirect to login page
              header("location: welcomepatient.php");
          } else{
              echo "Oops! Something went wrong. Please try again later.";
          }

          // Close statement
          $stmt->close();
      }
  }
  


}

?>
 
 <!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">

  <title>Impact Bootstrap Template - Index</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

 
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,600;1,700&family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&family=Raleway:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/owlcarousel/owl.carousel.min.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <!-- Template Main CSS File -->
  <link href="assets/css/patient.css" rel="stylesheet">
  <!-- TIMER FUNCTION -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
    $(document).ready(function(){
      updateTime(); 
      setInterval(updateTime, 1000); 
    });

    function updateTime() {
      $.ajax({
        url: 'get_time.php', 
        type: 'GET',
        success: function(data) {
          $('#time').text(data); 
        }
      });
    }
  </script>
  <!-- =======================================================
  * Template Name: Impact
  * Updated: May 30 2023 with Bootstrap v5.3.0
  * Template URL: https://bootstrapmade.com/impact-bootstrap-business-website-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>
<body>

<header id="header" class="header d-flex align-items-center">

    <div class="container-fluid container-xl d-flex align-items-center justify-content-between">
      <a href="" class="logo d-flex align-items-center">

        <h1>Makiling Clinic</h1>


        <nav id="navbar" class="navbar">
        <ul>
          <li><a href="welcomepatient.php">Home</a></li>
          <li><a href="booking.php">Appointment booking</a></li>
          <li><a href="#services">Appointment History</a></li>
          <li class="dropdown"><a href="#"><span>Profile</span> <i class="bi bi-chevron-down dropdown-indicator"></i></a>
            <ul>
              <li><a data-bs-toggle="modal" data-bs-target="#userdetail">View Account details</a></li> 

              <li><a href="resetpass.php">Reset Password</a></li>    
              <li><a href="logout.php">Log Out</a></li>
            </ul>
          </li>
        </ul>
      </nav><!-- .navbar --><!-- .navbar -->



  </header>
  <div class="d-flex justify-content-center ">

<div class="mt-4 mb-0">
      <h4><b>&nbsp;Today's Date and Time&nbsp;</b>
      <div class="d-flex"> <?php echo $today?>&nbsp;||&nbsp;<div id="time"></h4>
 

 
</div>
</div>
</div>
<div class="container py-10 h-100 mb-5 mt-5">
<div class="row d-flex justify-content-center align-items-center h-100">
<div class="col col-xl-8">
<div class="card" style="border-radius: 1rem; background-color: white;">
  <div class="row gx-">
    <div class="col-md-10 col-lg-12 d-flex align-items-center">
      <div class="card-body p-4 p-lg-5 text-black">
        <form action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" method="post" id="appointment">
          <div class="d-flex align-items-center mb-3 pb-1 mr">
            <span class="h1 fw-bold mb-0">Book appointment</span>
          </div>

          <div class="form-outline mb-4">
            <label class="form-label" for="gender">Select doctor</label>
            <select name="docid" class="form-control form-control-lg <?php echo (!empty($docid_err)) ? 'is-invalid' : ''; ?>">
<option disabled selected>Select doctor</option>
<?php
$sql = "SELECT  doctor.docid, doctor.docname, specialties.id,specialties.sname
FROM doctor
JOIN specialties ON doctor.specialties = specialties.id;";
$result = $mysqli->query($sql);
while ($row = $result->fetch_assoc()) {
$docid = $row['docid'];
$sname = $row['sname'];
$docname = $row['docname'];
echo "<option value='$docid'>$sname - $docname</option>";

}
?>
</select>
            <span class="invalid-feedback"><?php echo $docid_err; ?></span>
          </div>
          <div class="form-outline mb-4">
          <label class="form-label" for="form2Example27">Appointment Date</label>
            <input type="date" id="appDate"  name="appDate" onkeydown="return false" onfocus="blur()"  class="form-control form-control-lg <?php echo (!empty($appDate_err)) ? 'is-invalid' : ''; ?>" value="<?php echo $appDate; ?>">
            <span class="invalid-feedback"><?php echo $appDate_err; ?></span>
          </div>
          <div class="form-outline mb-4">
          <!-- <label class="form-label" for="form2Example27">Appointment Time</label>
          <input type="time" id="appTime" name="appTime"  min="09:00" max="18:00" class="form-control form-control-lg"required>
          </div> -->
          <div class="form-outline mb-">
            <label class="form-label" for="appTime">Select Time</label>
            <select name="appTime" class="form-control form-control-lg<?php echo (!empty($appTime_err)) ? 'is-invalid' : ''; ?>" value="<?php echo $appTIme; ?>">
            <option disabled selected>Select Time</option>
            <option value="1">8:00 AM - 9:00 AM</option>
            <option value="2">9:00 AM - 10:0 0AM</option>
            <option value="3">10:00 AM - 11:00 AM</option>
            <option value="4">11:00 PM- 12:00 PM</option>
            <option disabled selected>Break TIme</option>
            <option value="5">1:00 PM - 2:00PM</option>
            <option value="6">2:00 PM - 3:00PM</option>
            <option value="7">3:00 PM - 4:00PM</option>
            <option value="8">4:00 PM - 5:00PM</option>
            <option value="9">5:00 PM - 6:00PM</option>
          </select>       
          <span class="invalid-feedback"><?php echo $appTime_err; ?></span>           
          </div>
          <div class="pt-1 mb-4">
            <input type="submit" class="btn btn-dark btn-lg" value="Submit"><br><br>
            <p class="mb-0 pb-lg-2" style="color: #393f81;"><a href="Loginemp.php"></a></p>
          </div>
        </form>
        <table class="table table-bordered table-default w-">
    <thead class="table-secondary">
            <th>Doctor name</th>
            <th>Specialty ID</th>
            <th>Specialties</th>

            </div>
        </tr>
    </thead>

</tbody>
<?php
// Loop through the result set and generate table rows
$sql = "SELECT  doctor.docname, specialties.id,specialties.sname
FROM doctor
JOIN specialties ON doctor.specialties = specialties.id;";
$result = $mysqli->query($sql); 
if ($result->num_rows > 0) {
    while ($row = $result->fetch_assoc()) {
        echo "<tr>";
        echo "<td>" . $row['docname'] . "</td>";
        echo "<td>" . $row['id'] . "</td>";
        echo "<td>" . $row['sname'] . "</td>";
        echo "</tr>";
    }
} else {
    echo "<tr><td colspan='4'>No data available</td></tr>";
}
?>
      </div>
    </div>
  </div>
</div>
</div>
</div>
</div>

  <!-- Modals -->
  <!-- Modal -->
  <div class="modaltext">
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Account Details</h1>
      </div>
      <div class="modal-body">
      <h5>Name</H5><h3 ><?php echo htmlspecialchars($_SESSION["pname"]); ?></h3>
      <h5 class ="mt-3">Email</H5><h3 ><?php echo htmlspecialchars($_SESSION["email"]); ?></h3>
      <h5 class ="mt-3">Cellphone Number</H5><h3 ><?php echo htmlspecialchars($_SESSION["pcellphone"]); ?></h3>
      <h5 class ="mt-3">Gender</H5><h3 ><?php echo htmlspecialchars($_SESSION["pGender"]); ?></h3>
      <h5 class ="mt-3">Birthday</H5><h3 ><?php echo htmlspecialchars($_SESSION["pBirthday"]); ?></h3>
      <h5 class ="mt-3">Address</H5><h3 ><?php echo htmlspecialchars($_SESSION["pAddress"]); ?></h3>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
      </div>
</body>
<!-- Vendor JS Files -->
<script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/vendor/aos/aos.js"></script>
<script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
<script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
<script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
<script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
<script src="assets/vendor/php-email-form/validate.js"></script>
<script src="assets/owlcarousel/owl.carousel.js"></script>
<script src="assets/owlcarousel/owl.carousel.min.js"></script>


<!-- Template Main JS File -->
<script src="assets/js/main.js"></script>

</body>

</html>



<!-- s -->
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
  $docid = $_POST['docid'];
  $appDate = $_POST['appDate'];
  $appTime = $_POST['appTime'];
$docid = intval($docid);

  echo "Name: " .  $docid . "<br>";
  echo "Email: " . $appDate . "<br>";
  echo "Email: " . $appTime . "<br>";


<!-- SD -->
<?PHP
if(empty($_POST["appTime"])){
      $appTime_err = "Please select application TIme.";     
  } else{

      // Prepare a select statement
      $sql1 = "SELECT appointment_ID from appointments where docid = ? and appTime = ? and appDate = ?";
      
      if($stmt = $mysqli->prepare($sql1)){
          // Bind variables to the prepared statement as parameters
          $stmt->bind_param("sss",$param_docid, $param_appDate, $param_appTime );

          // Set parameters
          $param_docid = trim($_POST["docid"]);
          $param_appDate= trim($_POST["appDate"]);
          $param_appTime= trim($_POST["appTime"]);
          
          
          // Attempt to execute the prepared statement
          if($stmt->execute()){
              // store result
              $stmt->store_result();
              
              if($stmt->num_rows == 1){
                  $appTime_err = "This Appointment is already taken.";
              } else{
                $appTime = intval($_POST["appTime"]);
                  $appTime= trim($_POST["appTime"]);
                  $appDate= trim($_POST["appDate"]);

              }
          } else{
              echo "Oops! Something went wrong. Please try again later.";
          }

          // Close statement
          $stmt->close();
      }
  }
?>
  <!-- // tester -->
  <?php
  $t = 18;

  if ($t < 16) {
    echo '
    <div class="d-flex justify-content-center">
  <h3>You have no upcoming appointment</h3>
  </div>';
  } else {
    echo "              
    <div
    <h4>Doctor:</h4>
    <h4>Department:</h4>
    <h4>Scheduled Date:</h4>
    <h4>Scheduled Time:</h4>
    <h4>Note:</h4>";
  }
  ?>